import numpy as np
import scipy.sparse as spsp


def __e_lr(m):
    e_l = spsp.coo_array(([1], ([0], [0])), shape=(m, 1)).tocsr()
    e_r = spsp.coo_array(([1], ([m - 1], [0])), shape=(m, 1)).tocsr()
    return e_l, e_r


def __extend_WESN(Im, op_l, op_r):
    opW = spsp.kron(op_l, Im, 'csr')
    opE = spsp.kron(op_r, Im, 'csr')
    opS = spsp.kron(Im, op_l, 'csr')
    opN = spsp.kron(Im, op_r, 'csr')
    return opW, opE, opS, opN


def ops_2d(m, b, ops_1d):
    """
    Returns 4th order accurate 2D operators for a square m*m-grid with wave speeds b.
    The operators are HH, D2 in x- and y-directions, and two tuples with e and d-operators
    for W, E, S, N.

    @return: HH, HHI, (D2x, D2y), (eW, eE, eS, eN), (d1_W, d1_E, d1_S, d1_N)
    @param b: (m*m, 1) matrix containing wave speeds in column-first order
    @param m: number of grid points per direction
    @param ops_1d: 1D operators from D2_Variable_4
    """
    H, HI, D1, D2_fun, e_l, e_r, d1_l, d1_r = ops_1d
    N = m * m

    ind = np.reshape(np.arange(N), (m, m))
    b = b.reshape((N,))

    # D2y is just diag(D2(b(x,:))) which is very easy to build.
    # D2x is much more annoying to build, but using that a column
    # first matrix can be arranged to a row first matrix using a
    # perfect shuffle matrix such that B kron A = S (A kron B) S^T
    # This makes life very easy for us :)
    I_N = spsp.eye(N, format='lil')
    S = spsp.vstack([I_N[i::m, :] for i in range(m)]).tocsr()

    rows = []
    cols = []
    prev_row = b[ind[:, 0]]
    prev_col = b[ind[0, :]]
    D2s = {}  # D2 operator for a given line
    row_start_i = 0
    col_start_i = 0
    for i in range(m):
        row = b[ind[:, i]]
        col = b[ind[i, :]]
        if row.tobytes() not in D2s:
            D2s[row.tobytes()] = D2_fun(row)
        if col.tobytes() not in D2s:
            D2s[col.tobytes()] = D2_fun(col)
        if not np.array_equal(row, prev_row) and i != 0:
            rows += [D2s[prev_row.tobytes()]] * (i - row_start_i)
            prev_row = row
            row_start_i = i
        if not np.array_equal(col, prev_col) and i != 0:
            cols += [D2s[prev_col.tobytes()]] * (i - col_start_i)
            prev_col = col
            col_start_i = i
    # add the last rows and cols, since they're only added during changes
    rows += [D2s[prev_row.tobytes()]] * (m - row_start_i)
    cols += [D2s[prev_col.tobytes()]] * (m - col_start_i)

    D2x = S @ spsp.block_diag(rows) @ S.T
    D2y = spsp.block_diag(cols)
    # D2x = S @ spsp.block_diag([D2_fun(b[ind[:, i]]) for i in range(m)]).tocsr() @ S.T
    # D2y = spsp.block_diag([D2_fun(b[ind[i, :]]) for i in range(m)]).tocsr()

    Im = spsp.eye(m)
    HH = spsp.kron(H, H, 'dia')
    HHI = spsp.kron(HI, HI, 'dia')
    e_ops = __extend_WESN(Im, e_l, e_r)
    d_ops = __extend_WESN(Im, d1_l, d1_r)

    return HH, HHI, (D2x, D2y), e_ops, d_ops


def D2_Variable(m, h, order):
    if order == 2:
        ops = D2_Variable_2(m, h)
    elif order == 4:
        ops = D2_Variable_4(m, h)
    elif order == 6:
        ops = D2_Variable_6(m, h)
    else:
        raise ValueError(f'Order {order} not implemented')
    return ops


def __d_from_stencil(d_stenc, m):
    d1_l = spsp.lil_array((m, 1))
    w = len(d_stenc)
    d1_l[:w] = d_stenc
    d1_l = d1_l.tocsr()

    d1_r = spsp.lil_array((m, 1))
    d1_r[-w:] = np.flip(-d_stenc)
    d1_r = d1_r.tocsr()
    return d1_l, d1_r


def D2_Variable_2(m, h):
    e_l, e_r = __e_lr(m)

    H_diag = np.ones(m)
    H_diag[0] = 0.5
    H_diag[-1] = 0.5
    H_diag = h * H_diag
    H = spsp.diags(H_diag)
    HI = spsp.diags(1 / H_diag)

    d_stenc = np.array([-3 / 2, 2, -1 / 2]) / h
    d1_l, d1_r = __d_from_stencil(d_stenc, m)

    D1 = spsp.diags([-0.5, 0.5], [-1, 1], shape=(m, m), format='lil')
    D1[0, 0] = -1
    D1[0, 1] = 1
    D1[-1, -1] = 1
    D1[-1, -2] = -1
    D1 = D1.tocsr() / h

    def D2_fun(c):
        M = spsp.lil_matrix((m, m))
        for i in range(1, m - 1):
            M[i, i - 1:i + 2] = [-c[i - 1] / 2 - c[i] / 2,
                                 c[i - 1] / 2 + c[i] + c[i + 1] / 2,
                                 -c[i] / 2 - c[i + 1] / 2]

        M[0:2, 0:2] = [[c[0] / 2 + c[1] / 2, -c[0] / 2 - c[1] / 2],
                       [-c[0] / 2 - c[1] / 2, c[0] / 2 + c[1] + c[2] / 2]]
        M[m - 2:, m - 2:] = [[c[m - 3] / 2 + c[m - 2] + c[m - 1] / 2, -c[m - 2] / 2 - c[m - 1] / 2],
                             [-c[m - 2] / 2 - c[m - 1] / 2, c[m - 2] / 2 + c[m - 1] / 2]]

        M = (M / h).tocsr()
        D2 = HI @ (-M - spsp.diags(c, shape=(m, m)) @ ((e_l @ d1_l.transpose()) - (e_r @ d1_r.transpose())))
        return D2

    return H, HI, D1, D2_fun, e_l, e_r, d1_l, d1_r


def D2_Variable_4(m, h):
    """Returns fourth order accurate H, HI, D1, D2_fun, e_l, e_r, d1_l, d1_r in sparse format"""
    e_l, e_r = __e_lr(m)

    H_diag = np.ones(m)
    H_diag[:4] = [17 / 48, 59 / 48, 43 / 48, 49 / 48]
    H_diag[-4:] = [49 / 48, 43 / 48, 59 / 48, 17 / 48]
    H_diag = H_diag * h
    H = spsp.diags(H_diag)
    HI = spsp.diags(1 / H_diag)

    Q = spsp.diags([-1 / 12, 8 / 12, -8 / 12, 1 / 12], [2, 1, -1, -2], (m, m)).tolil()
    Q_U = np.array([[0, 59 / 96, -1 / 12, -1 / 32], [-59 / 96, 0, 59 / 96, 0],
                    [1 / 12, -59 / 96, 0, 59 / 96], [1 / 32, 0, -59 / 96, 0]])
    Q[0:4, 0:4] = Q_U
    Q[-4:, -4:] = np.flipud(np.fliplr(-Q_U))
    Q = Q.tocsr()

    D1 = HI @ (Q - 1 / 2 * (e_l @ e_l.transpose()) + 1 / 2 * (e_r @ e_r.transpose()))

    d_stenc = np.array([-11 / 6, 3, -3 / 2, 1 / 3]) / h
    d1_l, d1_r = __d_from_stencil(d_stenc, m)

    def D2_fun(c):
        """
        Given a vector with wave speeds c of length m, returns an m*m matrix
        approximating the second derivative on m

        @param c: an array of length m
        @rtype: scipy.sparse.csr_matrix
        @return: a sparse csr m*m matrix approximating the second derivative
        """
        M = spsp.lil_matrix((m, m))

        for i in range(3, m - 3):
            M[i, i - 2:i + 3] = np.array([-c[i - 1] / 6 + c[i - 2] / 8 + c[i] / 8,
                                          -c[i - 2] / 6 - c[i + 1] / 6 - c[i - 1] / 2 - c[i] / 2,
                                          c[i - 2] / 24 + 5 / 6 * c[i - 1] + 5 / 6 * c[i + 1] + c[
                                              i + 2] / 24 + 3 / 4 * c[i],
                                          -c[i - 1] / 6 - c[i + 2] / 6 - c[i] / 2 - c[i + 1] / 2,
                                          -c[i + 1] / 6 + c[i] / 8 + c[i + 2] / 8])

        M[:6, :6] = np.array([
            [12 / 17 * c[0] + 59 / 192 * c[1] + 27010400129 / 345067064608 * c[
                2] + 69462376031 / 2070402387648 * c[3],
             -59 / 68 * c[0] - 6025413881 / 21126554976 * c[2] - 537416663 / 7042184992 * c[3],
             2 / 17 * c[0] - 59 / 192 * c[1] + 213318005 / 16049630912 * c[
                 3] + 2083938599 / 8024815456 * c[2],
             3 / 68 * c[0] - 1244724001 / 21126554976 * c[2] + 752806667 / 21126554976 * c[3],
             49579087 / 10149031312 * c[2] - 49579087 / 10149031312 * c[3],
             -c[3] / 784 + c[2] / 784]
            , [
                -59 / 68 * c[0] - 6025413881 / 21126554976 * c[2] - 537416663 / 7042184992 * c[
                    3],
                3481 / 3264 * c[0] + 9258282831623875 / 7669235228057664 * c[
                    2] + 236024329996203 / 1278205871342944 * c[3],
                -59 / 408 * c[0] - 29294615794607 / 29725717938208 * c[
                    2] - 2944673881023 / 29725717938208 * c[3],
                -59 / 1088 * c[0] + 260297319232891 / 2556411742685888 * c[
                    2] - 60834186813841 / 1278205871342944 * c[3],
                -1328188692663 / 37594290333616 * c[2] + 1328188692663 / 37594290333616 * c[3],
                -8673 / 2904112 * c[2] + 8673 / 2904112 * c[3]]
            , [
                2 / 17 * c[0] - 59 / 192 * c[1] + 213318005 / 16049630912 * c[
                    3] + 2083938599 / 8024815456 * c[2],
                -59 / 408 * c[0] - 29294615794607 / 29725717938208 * c[
                    2] - 2944673881023 / 29725717938208 * c[3],
                c[0] / 51 + 59 / 192 * c[1] + 13777050223300597 / 26218083221499456 * c[
                    3] + 564461 / 13384296 * c[4] + 378288882302546512209 / 270764341349677687456 * c[2],
                c[0] / 136 - 125059 / 743572 * c[4] - 4836340090442187227 / 5525802884687299744 * c[
                    2] - 17220493277981 / 89177153814624 * c[3],
                -10532412077335 / 42840005263888 * c[3] + 1613976761032884305 / 7963657098519931984 * c[
                    2] + 564461 / 4461432 * c[4],
                -960119 / 1280713392 * c[3] - 3391 / 6692148 * c[
                    4] + 33235054191 / 26452850508784 * c[2]]
            , [
                3 / 68 * c[0] - 1244724001 / 21126554976 * c[2] + 752806667 / 21126554976 * c[3],
                -59 / 1088 * c[0] + 260297319232891 / 2556411742685888 * c[
                    2] - 60834186813841 / 1278205871342944 * c[3],
                c[0] / 136 - 125059 / 743572 * c[4] - 4836340090442187227 / 5525802884687299744 * c[
                    2] - 17220493277981 / 89177153814624 * c[3],
                3 / 1088 * c[0] + 507284006600757858213 / 475219048083107777984 * c[
                    2] + 1869103 / 2230716 * c[4] + c[5] / 24 + 1950062198436997 / 3834617614028832 *
                c[3],
                -4959271814984644613 / 20965546238960637264 * c[2] - c[
                    5] / 6 - 15998714909649 / 37594290333616 * c[3] - 375177 / 743572 * c[4],
                -368395 / 2230716 * c[4] + 752806667 / 539854092016 * c[2] + 1063649 / 8712336 * c[
                    3] + c[5] / 8]
            , [
                49579087 / 10149031312 * c[2] - 49579087 / 10149031312 * c[3],
                -1328188692663 / 37594290333616 * c[2] + 1328188692663 / 37594290333616 * c[3],
                -10532412077335 / 42840005263888 * c[3] + 1613976761032884305 / 7963657098519931984 * c[
                    2] + 564461 / 4461432 * c[4],
                -4959271814984644613 / 20965546238960637264 * c[2] - c[
                    5] / 6 - 15998714909649 / 37594290333616 * c[3] - 375177 / 743572 * c[4],
                8386761355510099813 / 128413970713633903242 * c[
                    2] + 2224717261773437 / 2763180339520776 * c[3] + 5 / 6 * c[5] + c[
                    6] / 24 + 280535 / 371786 * c[4],
                -35039615 / 213452232 * c[3] - c[6] / 6 - 13091810925 / 13226425254392 * c[
                    2] - 1118749 / 2230716 * c[4] - c[5] / 2]
            , [
                -c[3] / 784 + c[2] / 784,
                -8673 / 2904112 * c[2] + 8673 / 2904112 * c[3],
                -960119 / 1280713392 * c[3] - 3391 / 6692148 * c[
                    4] + 33235054191 / 26452850508784 * c[2],
                -368395 / 2230716 * c[4] + 752806667 / 539854092016 * c[2] + 1063649 / 8712336 * c[
                    3] + c[5] / 8,
                -35039615 / 213452232 * c[3] - c[6] / 6 - 13091810925 / 13226425254392 * c[
                    2] - 1118749 / 2230716 * c[4] - c[5] / 2,
                3290636 / 80044587 * c[3] + 5580181 / 6692148 * c[4] + 5 / 6 * c[6] + c[
                    7] / 24 + 660204843 / 13226425254392 * c[2] + 3 / 4 * c[5]]])

        M[m - 6:, m - 6:] = np.array([
            [c[m - 8] / 24 + 5 / 6 * c[m - 7] + 5580181 / 6692148 * c[
                m - 5] + 4887707739997 / 119037827289528 * c[m - 4] + 3 / 4 * c[
                 m - 6] + 660204843 / 13226425254392 * c[m - 3] + 660204843 / 13226425254392 * c[m - 2],
             -c[m - 7] / 6 - 1618585929605 / 9919818940794 * c[m - 4] - c[
                 m - 6] / 2 - 1118749 / 2230716 * c[m - 5] - 13091810925 / 13226425254392 * c[
                 m - 3] - 13091810925 / 13226425254392 * c[m - 2],
             -368395 / 2230716 * c[m - 5] + c[m - 6] / 8 + 48866620889 / 404890569012 * c[
                 m - 4] + 752806667 / 539854092016 * c[m - 3] + 752806667 / 539854092016 * c[m - 2],
             -3391 / 6692148 * c[m - 5] - 238797444493 / 119037827289528 * c[
                 m - 4] + 33235054191 / 26452850508784 * c[m - 3] + 33235054191 / 26452850508784 * c[
                 m - 2],
             -8673 / 2904112 * c[m - 3] - 8673 / 2904112 * c[m - 2] + 8673 / 1452056 * c[m - 4],
             -c[m - 4] / 392 + c[m - 3] / 784 + c[m - 2] / 784]
            , [
                -c[m - 7] / 6 - 1618585929605 / 9919818940794 * c[m - 4] - c[
                    m - 6] / 2 - 1118749 / 2230716 * c[m - 5] - 13091810925 / 13226425254392 * c[
                    m - 3] - 13091810925 / 13226425254392 * c[m - 2],
                c[m - 7] / 24 + 5 / 6 * c[m - 6] + 3896014498639 / 4959909470397 * c[
                    m - 4] + 8386761355510099813 / 128413970713633903242 * c[m - 3] + 280535 / 371786 * c[
                    m - 5] + 3360696339136261875 / 171218627618178537656 * c[m - 2],
                -c[m - 6] / 6 - 4959271814984644613 / 20965546238960637264 * c[
                    m - 3] - 375177 / 743572 * c[m - 5] - 13425842714 / 33740880751 * c[
                    m - 4] - 193247108773400725 / 6988515412986879088 * c[m - 2],
                -365281640980 / 1653303156799 * c[m - 4] + 564461 / 4461432 * c[
                    m - 5] + 1613976761032884305 / 7963657098519931984 * c[
                    m - 3] - 198407225513315475 / 7963657098519931984 * c[m - 2],
                -1328188692663 / 37594290333616 * c[m - 3] + 2226377963775 / 37594290333616 * c[
                    m - 2] - 8673 / 363014 * c[m - 4],
                c[m - 4] / 49 + 49579087 / 10149031312 * c[m - 3] - 256702175 / 10149031312 * c[
                    m - 2]]
            , [
                -368395 / 2230716 * c[m - 5] + c[m - 6] / 8 + 48866620889 / 404890569012 * c[
                    m - 4] + 752806667 / 539854092016 * c[m - 3] + 752806667 / 539854092016 * c[m - 2],
                -c[m - 6] / 6 - 4959271814984644613 / 20965546238960637264 * c[
                    m - 3] - 375177 / 743572 * c[m - 5] - 13425842714 / 33740880751 * c[
                    m - 4] - 193247108773400725 / 6988515412986879088 * c[m - 2],
                c[m - 6] / 24 + 1869103 / 2230716 * c[
                    m - 5] + 507284006600757858213 / 475219048083107777984 * c[m - 3] + 3 / 1088 * c[
                    m - 1] + 31688435395 / 67481761502 * c[
                    m - 4] + 27769176016102795561 / 712828572124661666976 * c[m - 2],
                -125059 / 743572 * c[m - 5] + c[m - 1] / 136 - 23099342648 / 101222642253 * c[
                    m - 4] - 4836340090442187227 / 5525802884687299744 * c[
                    m - 3] + 193950157930938693 / 5525802884687299744 * c[m - 2],
                260297319232891 / 2556411742685888 * c[m - 3] - 59 / 1088 * c[
                    m - 1] - 106641839640553 / 1278205871342944 * c[m - 2] + 26019 / 726028 * c[m - 4],
                -1244724001 / 21126554976 * c[m - 3] + 3 / 68 * c[
                    m - 1] + 752806667 / 21126554976 * c[m - 2]]
            , [
                -3391 / 6692148 * c[m - 5] - 238797444493 / 119037827289528 * c[
                    m - 4] + 33235054191 / 26452850508784 * c[m - 3] + 33235054191 / 26452850508784 * c[
                    m - 2],
                -365281640980 / 1653303156799 * c[m - 4] + 564461 / 4461432 * c[
                    m - 5] + 1613976761032884305 / 7963657098519931984 * c[
                    m - 3] - 198407225513315475 / 7963657098519931984 * c[m - 2],
                -125059 / 743572 * c[m - 5] + c[m - 1] / 136 - 23099342648 / 101222642253 * c[
                    m - 4] - 4836340090442187227 / 5525802884687299744 * c[
                    m - 3] + 193950157930938693 / 5525802884687299744 * c[m - 2],
                564461 / 13384296 * c[m - 5] + 470299699916357 / 952302618316224 * c[
                    m - 4] + 550597048646198778781 / 1624586048098066124736 * c[m - 2] + c[
                    m - 1] / 51 + 378288882302546512209 / 270764341349677687456 * c[m - 3],
                -59 / 408 * c[m - 1] - 29294615794607 / 29725717938208 * c[
                    m - 3] - 2234477713167 / 29725717938208 * c[m - 2] - 8673 / 363014 * c[m - 4],
                -59 / 3136 * c[m - 4] - 13249937023 / 48148892736 * c[m - 2] + 2 / 17 * c[
                    m - 1] + 2083938599 / 8024815456 * c[m - 3]]
            , [
                -8673 / 2904112 * c[m - 3] - 8673 / 2904112 * c[m - 2] + 8673 / 1452056 * c[m - 4],
                -1328188692663 / 37594290333616 * c[m - 3] + 2226377963775 / 37594290333616 * c[
                    m - 2] - 8673 / 363014 * c[m - 4],
                260297319232891 / 2556411742685888 * c[m - 3] - 59 / 1088 * c[
                    m - 1] - 106641839640553 / 1278205871342944 * c[m - 2] + 26019 / 726028 * c[m - 4],
                -59 / 408 * c[m - 1] - 29294615794607 / 29725717938208 * c[
                    m - 3] - 2234477713167 / 29725717938208 * c[m - 2] - 8673 / 363014 * c[m - 4],
                9258282831623875 / 7669235228057664 * c[m - 3] + 3481 / 3264 * c[
                    m - 1] + 228389721191751 / 1278205871342944 * c[m - 2] + 8673 / 1452056 * c[m - 4],
                -6025413881 / 21126554976 * c[m - 3] - 59 / 68 * c[
                    m - 1] - 537416663 / 7042184992 * c[m - 2]]
            , [
                -c[m - 4] / 392 + c[m - 3] / 784 + c[m - 2] / 784,
                c[m - 4] / 49 + 49579087 / 10149031312 * c[m - 3] - 256702175 / 10149031312 * c[
                    m - 2],
                -1244724001 / 21126554976 * c[m - 3] + 3 / 68 * c[
                    m - 1] + 752806667 / 21126554976 * c[m - 2],
                -59 / 3136 * c[m - 4] - 13249937023 / 48148892736 * c[m - 2] + 2 / 17 * c[
                    m - 1] + 2083938599 / 8024815456 * c[m - 3],
                -6025413881 / 21126554976 * c[m - 3] - 59 / 68 * c[
                    m - 1] - 537416663 / 7042184992 * c[m - 2],
                3 / 3136 * c[m - 4] + 27010400129 / 345067064608 * c[
                    m - 3] + 234566387291 / 690134129216 * c[m - 2] + 12 / 17 * c[m - 1]]])

        M = (M / h).tocsr()
        D2 = HI @ (-M - spsp.diags(c, shape=(m, m)) @ ((e_l @ d1_l.transpose()) - (e_r @ d1_r.transpose())))
        return D2

    return H, HI, D1, D2_fun, e_l, e_r, d1_l, d1_r


def D2_Variable_6(m, h):
    e_l, e_r = __e_lr(m)

    H_diag = np.ones(m)
    H_diag[:6] = [13649 / 43200, 12013 / 8640, 2711 / 4320, 5359 / 4320, 7877 / 8640, 43801 / 43200]
    H_diag[-6:] = [43801 / 43200, 7877 / 8640, 5359 / 4320, 2711 / 4320, 12013 / 8640, 13649 / 43200]
    H_diag = H_diag * h
    H = spsp.diags(H_diag)
    HI = spsp.diags(1 / H_diag)

    x1 = 0.70127127127127

    D1 = spsp.diags([-1 / 60, 3 / 20, -3 / 4, 3 / 4, -3 / 20, 1], [-3, -2, -1, 1, 2, 3], shape=(m, m), format='lil')

    D1[:6, :9] = np.array([
        [-21600 / 13649, 43200 / 13649 * x1 - 7624 / 40947, -172800 / 13649 * x1 + 715489 / 81894,
         259200 / 13649 * x1 - 187917 / 13649, -172800 / 13649 * x1 + 735635 / 81894,
         43200 / 13649 * x1 - 89387 / 40947, 0, 0, 0]
        , [
            -8640 / 12013 * x1 + 7624 / 180195, 0, 86400 / 12013 * x1 - 57139 / 12013,
            -172800 / 12013 * x1 + 745733 / 72078, 129600 / 12013 * x1 - 91715 / 12013,
            -34560 / 12013 * x1 + 240569 / 120130, 0, 0, 0]
        , [
            17280 / 2711 * x1 - 715489 / 162660, -43200 / 2711 * x1 + 57139 / 5422, 0,
            86400 / 2711 * x1 - 176839 / 8133, -86400 / 2711 * x1 + 242111 / 10844, 25920 / 2711 * x1 - 182261 / 27110,
            0, 0, 0]
        , [
            -25920 / 5359 * x1 + 187917 / 53590, 86400 / 5359 * x1 - 745733 / 64308,
            -86400 / 5359 * x1 + 176839 / 16077, 0, 43200 / 5359 * x1 - 165041 / 32154,
            -17280 / 5359 * x1 + 710473 / 321540, 72 / 5359, 0, 0]
        , [
            34560 / 7877 * x1 - 147127 / 47262, -129600 / 7877 * x1 + 91715 / 7877, 172800 / 7877 * x1 - 242111 / 15754,
            -86400 / 7877 * x1 + 165041 / 23631, 0, 8640 / 7877 * x1, -1296 / 7877, 144 / 7877, 0]
        , [
            -43200 / 43801 * x1 + 89387 / 131403, 172800 / 43801 * x1 - 240569 / 87602,
            -259200 / 43801 * x1 + 182261 / 43801, 172800 / 43801 * x1 - 710473 / 262806, -43200 / 43801 * x1, 0,
            32400 / 43801, -6480 / 43801, 720 / 43801]])
    D1[-6:, -9:] = np.flipud(np.fliplr(-D1[:6, :9].toarray()))

    D1 = (D1 / h).tocsr()

    d_stenc = np.array([-25 / 12, 4, -3, 4 / 3, -1 / 4]) / h
    d1_l, d1_r = __d_from_stencil(d_stenc, m)

    def D2_fun(c):
        M = spsp.lil_matrix((m, m))

        for i in range(3, m - 3):
            M[i, i - 3:i + 4] = np.array([
                c[i - 2] / 0.40e2 + c[i - 1] / 0.40e2 - 0.11e2 / 0.360e3 * c[i - 3] - 0.11e2 / 0.360e3 * c[i],
                c[i - 3] / 0.20e2 - 0.3e1 / 0.10e2 * c[i - 1] + c[i + 1] / 0.20e2 + 0.7e1 / 0.40e2 * c[
                    i] + 0.7e1 / 0.40e2 * c[i - 2],
                -c[i - 3] / 0.40e2 - 0.3e1 / 0.10e2 * c[i - 2] - 0.3e1 / 0.10e2 * c[i + 1] - c[
                    i + 2] / 0.40e2 - 0.17e2 / 0.40e2 * c[i] - 0.17e2 / 0.40e2 * c[i - 1],
                c[i - 3] / 0.180e3 + c[i - 2] / 0.8e1 + 0.19e2 / 0.20e2 * c[i - 1] + 0.19e2 / 0.20e2 * c[i + 1] + c[
                    i + 2] / 0.8e1 + c[i + 3] / 0.180e3 + 0.101e3 / 0.180e3 * c[i],
                -c[i - 2] / 0.40e2 - 0.3e1 / 0.10e2 * c[i - 1] - 0.3e1 / 0.10e2 * c[i + 2] - c[
                    i + 3] / 0.40e2 - 0.17e2 / 0.40e2 * c[i] - 0.17e2 / 0.40e2 * c[i + 1],
                c[i - 1] / 0.20e2 - 0.3e1 / 0.10e2 * c[i + 1] + c[i + 3] / 0.20e2 + 0.7e1 / 0.40e2 * c[
                    i] + 0.7e1 / 0.40e2 * c[i + 2],
                c[i + 1] / 0.40e2 + c[i + 2] / 0.40e2 - 0.11e2 / 0.360e3 * c[i] - 0.11e2 / 0.360e3 * c[i + 3]
            ])

        M[0:9, 0:9] = np.array([
            [
                0.7912667594695582093926295e0 * c[0] + 0.2968472090638000742888467e0 * c[
                    1] + 0.3185519088796429015220016e-2 * c[2] + 0.1632404042590951953384672e-1 * c[
                    3] + 0.3160302244094415087693968e-1 * c[4] + 0.3167964748016105299646518e-1 * c[
                    5] + 0.3148577733947253920469418e-1 * c[6],
                -0.1016689339350338144430605e1 * c[0] - 0.2845627370491611369031341e-1 * c[
                    2] - 0.4128029838349298819825156e-1 * c[3] - 0.1392281451620140507549866e0 * c[
                    4] - 0.1195777325611201766551392e0 * c[5] - 0.1194267756529333410855186e0 * c[6],
                0.7075642937243715046279337e-1 * c[0] - 0.1845476106024151050283847e0 * c[
                    1] - 0.4364163147111892346990101e-1 * c[3] + 0.2432367907207732460874765e0 * c[
                    4] + 0.1582127073537215443965653e0 * c[5] + 0.1602348578364786307613271e0 * c[6],
                0.2251991532891353212689574e0 * c[0] - 0.1662748711097054895317080e0 * c[
                    1] + 0.2710530961648671297733465e-1 * c[2] - 0.1916646185968439909125616e0 * c[
                    4] - 0.7684117160199014594442072e-1 * c[5] - 0.8219586949831697575883635e-1 * c[6],
                -0.5224403464202056316702078e-1 * c[0] + 0.4440063948509876221050939e-1 * c[
                    1] - 0.1023976547309387874453988e-2 * c[2] + 0.7403484645316174090533193e-1 * c[
                    3] + 0.1241625568998496895352046e-1 * c[5] + 0.7188652847892601282652228e-1 * c[
                    4] + 0.1379362997104735503447960e-1 * c[6],
                -0.1828896813877197352675410e-1 * c[0] + 0.9574633163221758060736592e-2 * c[
                    1] - 0.8105784530576404277872603e-3 * c[2] - 0.7348845587775519698437916e-2 * c[
                    3] + 0.1063601949723906997026904e-1 * c[4] - 0.1315967038382618382356495e-1 * c[
                    5] - 0.2117936478838753524581943e-1 * c[6],
                0.1911888563316170927411831e-2 * c[3] - 0.4068130355529149936100229e-1 * c[
                    4] + 0.1319674981073749167009902e-1 * c[5] + 0.2557266518123783676349144e-1 * c[6],
                0.1559652871136785763960685e-1 * c[4] - 0.6486184157331537899459796e-2 * c[
                    5] - 0.9110344554036319740147054e-2 * c[6],
                0.5593983696629863059347067e-3 * c[5] - 0.1384822535100796372263822e-2 * c[
                    4] + 0.8254241654378100663291154e-3 * c[6]
            ], [
                -0.1016689339350338144430605e1 * c[0] - 0.2845627370491611369031341e-1 * c[
                    2] - 0.4128029838349298819825156e-1 * c[3] - 0.1392281451620140507549866e0 * c[
                    4] - 0.1195777325611201766551392e0 * c[5] - 0.1194267756529333410855186e0 * c[6],
                0.1306332157111667628555907e1 * c[0] + 0.2542001760457345743492403e0 * c[
                    2] + 0.1043897828092562609502636e0 * c[3] + 0.6672328021032112950919876e0 * c[
                    4] + 0.4681819359722749441073885e0 * c[5] + 0.4676415410195836920069412e0 * c[6],
                -0.9091410269992464604926176e-1 * c[0] + 0.1103611313171476425250639e0 * c[
                    3] - 0.1290397544997518887000350e1 * c[4] - 0.6639605248735044787146222e0 * c[
                    5] - 0.6615974464005206184151509e0 * c[6],
                -0.2893557395653431666593814e0 * c[0] - 0.2421320004064592721552708e0 * c[
                    2] + 0.1187670255028031027693374e1 * c[4] + 0.3956598149904136332753521e0 * c[
                    5] + 0.3860048921755800000681479e0 * c[6],
                0.6712774475803763988977355e-1 * c[0] + 0.9147192682075630179962131e-2 * c[
                    2] - 0.1872196143003808021730728e0 * c[3] - 0.1319358558853174530078498e0 * c[
                    5] - 0.4871575736811911887376923e0 * c[4] - 0.1047516312275448138054418e0 * c[6],
                0.2349927974590068869356781e-1 * c[0] + 0.7240905383565181316381731e-2 * c[
                    2] + 0.1858378996391679448655070e-1 * c[3] - 0.9289616133938676174345208e-1 * c[
                    4] + 0.1223513270418807666970488e0 * c[5] + 0.1113520320436295033894092e0 * c[6],
                -0.4834791406446907590553793e-2 * c[3] + 0.2310683832687820403062715e0 * c[
                    4] - 0.1080774142196007991746827e0 * c[5] - 0.1181561776427343335410349e0 * c[6],
                -0.8368141434403455353724691e-1 * c[4] + 0.4093499466767054661591066e-1 * c[
                    5] + 0.4274641967636400692133626e-1 * c[6],
                -0.3576545132696983143406173e-2 * c[5] + 0.7389399124121078682094445e-2 * c[
                    4] - 0.3812853991424095538688273e-2 * c[6]
            ], [
                0.7075642937243715046279337e-1 * c[0] - 0.1845476106024151050283847e0 * c[
                    1] - 0.4364163147111892346990101e-1 * c[3] + 0.2432367907207732460874765e0 * c[
                    4] + 0.1582127073537215443965653e0 * c[5] + 0.1602348578364786307613271e0 * c[6],
                -0.9091410269992464604926176e-1 * c[0] + 0.1103611313171476425250639e0 * c[
                    3] - 0.1290397544997518887000350e1 * c[4] - 0.6639605248735044787146222e0 * c[
                    5] - 0.6615974464005206184151509e0 * c[6],
                0.6327161147136873807796515e-2 * c[0] + 0.1147318200715868527529827e0 * c[
                    1] + 0.1166740554279680007487795e0 * c[3] + 0.2766610808285444037240703e1 * c[
                    4] + 0.1070920689960817104203947e1 * c[5] + 0.1013161391032973057171717e1 * c[6],
                0.2013769413884797246646959e-1 * c[0] + 0.1033717994630886401730470e0 * c[
                    1] - 0.2913221621151742724258117e1 * c[4] - 0.8755807343482262259774782e0 * c[
                    5] - 0.6909957183488812426508351e0 * c[6],
                -0.4671751091575462868310238e-2 * c[0] - 0.2760353365637712827793337e-1 * c[
                    1] - 0.1979290298620869974478871e0 * c[3] + 0.5402985338373433052255418e0 * c[
                    5] + 0.1239177593031911077924537e1 * c[4] + 0.2628038050247358227280031e0 * c[6],
                -0.1635430866921887819487473e-2 * c[0] - 0.5952475275883259619711594e-2 * c[
                    1] + 0.1964682777744275219350831e-1 * c[3] + 0.3236640012639046600590714e0 * c[
                    4] - 0.4659516693228870973898560e0 * c[5] - 0.2217272720941736859420432e0 * c[6],
                -0.5111353189352474549563559e-2 * c[3] - 0.5355878163774754346032096e0 * c[
                    4] + 0.3328335104489738933610597e0 * c[5] + 0.2078656591178540157917135e0 * c[6],
                0.1824328174134289562208038e0 * c[4] - 0.1059816030196818445908057e0 * c[
                    5] - 0.7645121439374711162999809e-1 * c[6],
                0.9209089963443799485648361e-2 * c[5] - 0.1591502818872493167091475e-1 * c[
                    4] + 0.6705938225281132185266388e-2 * c[6]
            ], [
                0.2251991532891353212689574e0 * c[0] - 0.1662748711097054895317080e0 * c[
                    1] + 0.2710530961648671297733465e-1 * c[2] - 0.1916646185968439909125616e0 * c[
                    4] - 0.7684117160199014594442072e-1 * c[5] - 0.8219586949831697575883635e-1 * c[6],
                -0.2893557395653431666593814e0 * c[0] - 0.2421320004064592721552708e0 * c[
                    2] + 0.1187670255028031027693374e1 * c[4] + 0.3956598149904136332753521e0 * c[
                    5] + 0.3860048921755800000681479e0 * c[6],
                0.2013769413884797246646959e-1 * c[0] + 0.1033717994630886401730470e0 * c[
                    1] - 0.2913221621151742724258117e1 * c[4] - 0.8755807343482262259774782e0 * c[
                    5] - 0.6909957183488812426508351e0 * c[6],
                0.6409299775987186986730499e-1 * c[0] + 0.9313657638804699948929701e-1 * c[
                    1] + 0.2306367624634749229113646e0 * c[2] + 0.3689440308283716620260816e1 * c[
                    4] + 0.1190550338687608873798462e1 * c[5] + 0.5912479546888856519443605e0 * c[6],
                -0.1486895819265604128572498e-1 * c[0] - 0.2487040599390160764166412e-1 * c[
                    1] - 0.8712928907711754187084757e-2 * c[2] - 0.1263507837371824205693950e1 * c[
                    5] - 0.3058317397843997326920898e0 * c[6] - 0.1470691926045802954795783e1 * c[4],
                -0.5205147429855955657625694e-2 * c[0] - 0.5363098747528542488971874e-2 * c[
                    1] - 0.6897142765790609546343709e-2 * c[2] - 0.7857524521667450101721993e0 * c[
                    4] + 0.2291148005423734600066709e0 * c[6] + 0.9977064356292750529201981e0 * c[5],
                0.6697297488067662265210608e0 * c[4] - 0.5013247356072127938999311e0 * c[
                    5] - 0.1795161243106645437322408e0 * c[6],
                -0.2022909060111751565150958e0 * c[4] + 0.1453421858063658498587377e0 * c[
                    5] + 0.5694872020480930665635812e-1 * c[6],
                -0.1200429618441003833696998e-1 * c[5] - 0.4776915669385923841535432e-2 * c[
                    6] + 0.1678121185379596217850541e-1 * c[4]
            ], [
                -0.5224403464202056316702078e-1 * c[0] + 0.4440063948509876221050939e-1 * c[
                    1] - 0.1023976547309387874453988e-2 * c[2] + 0.7403484645316174090533193e-1 * c[
                    3] + 0.1241625568998496895352046e-1 * c[5] + 0.7188652847892601282652228e-1 * c[
                    4] + 0.1379362997104735503447960e-1 * c[6],
                0.6712774475803763988977355e-1 * c[0] + 0.9147192682075630179962131e-2 * c[
                    2] - 0.1872196143003808021730728e0 * c[3] - 0.1319358558853174530078498e0 * c[
                    5] - 0.4871575736811911887376923e0 * c[4] - 0.1047516312275448138054418e0 * c[6],
                -0.4671751091575462868310238e-2 * c[0] - 0.2760353365637712827793337e-1 * c[
                    1] - 0.1979290298620869974478871e0 * c[3] + 0.5402985338373433052255418e0 * c[
                    5] + 0.1239177593031911077924537e1 * c[4] + 0.2628038050247358227280031e0 * c[6],
                -0.1486895819265604128572498e-1 * c[0] - 0.2487040599390160764166412e-1 * c[
                    1] - 0.8712928907711754187084757e-2 * c[2] - 0.1263507837371824205693950e1 * c[
                    5] - 0.3058317397843997326920898e0 * c[6] - 0.1470691926045802954795783e1 * c[4],
                0.3449455095910233625229891e-2 * c[0] + 0.6641183499427826101618457e-2 * c[
                    1] + 0.3291545083271862858501887e-3 * c[2] + 0.3357721707576477199985656e0 * c[
                    3] + 0.2096413329579026439044119e1 * c[5] + 0.2317323204183126854954203e0 * c[
                    6] + 0.6107825764368264576481962e-2 * c[7] + 0.7109125850683376695640722e0 * c[4],
                0.1207544072304193806052558e-2 * c[0] + 0.1432116665752147607469646e-2 * c[
                    1] + 0.2605582646183255957264249e-3 * c[2] - 0.3332941113251635390801278e-1 * c[
                    3] - 0.2808241697385532683612407e0 * c[6] - 0.2720908083525083608370563e-1 * c[
                    7] + 0.1045865435682921987447929e0 * c[4] - 0.1348436986667115543203552e1 * c[5],
                0.8671038084174692625075159e-2 * c[3] + 0.1736073411355428563685818e0 * c[
                    5] + 0.5331362125287625412555844e-1 * c[7] - 0.2424935262404526301801157e0 * c[
                    4] + 0.1569015257678588270609004e0 * c[6],
                -0.8631683980217122275970376e-1 * c[5] + 0.2698842360470999243492629e-1 * c[
                    6] + 0.8098194147715651085292754e-1 * c[4] - 0.3276463639080639163926118e-1 * c[7],
                0.7462059484530855073291365e-2 * c[5] - 0.8121640361668678949573496e-3 * c[
                    6] + 0.5522702088127090209264064e-3 * c[7] - 0.7202165657176696199260422e-2 * c[4]
            ], [
                -0.1828896813877197352675410e-1 * c[0] + 0.9574633163221758060736592e-2 * c[
                    1] - 0.8105784530576404277872603e-3 * c[2] - 0.7348845587775519698437916e-2 * c[
                    3] + 0.1063601949723906997026904e-1 * c[4] - 0.1315967038382618382356495e-1 * c[
                    5] - 0.2117936478838753524581943e-1 * c[6],
                0.2349927974590068869356781e-1 * c[0] + 0.7240905383565181316381731e-2 * c[
                    2] + 0.1858378996391679448655070e-1 * c[3] - 0.9289616133938676174345208e-1 * c[
                    4] + 0.1223513270418807666970488e0 * c[5] + 0.1113520320436295033894092e0 * c[6],
                -0.1635430866921887819487473e-2 * c[0] - 0.5952475275883259619711594e-2 * c[
                    1] + 0.1964682777744275219350831e-1 * c[3] + 0.3236640012639046600590714e0 * c[
                    4] - 0.4659516693228870973898560e0 * c[5] - 0.2217272720941736859420432e0 * c[6],
                -0.5205147429855955657625694e-2 * c[0] - 0.5363098747528542488971874e-2 * c[
                    1] - 0.6897142765790609546343709e-2 * c[2] - 0.7857524521667450101721993e0 * c[
                    4] + 0.2291148005423734600066709e0 * c[6] + 0.9977064356292750529201981e0 * c[5],
                0.1207544072304193806052558e-2 * c[0] + 0.1432116665752147607469646e-2 * c[
                    1] + 0.2605582646183255957264249e-3 * c[2] - 0.3332941113251635390801278e-1 * c[
                    3] - 0.2808241697385532683612407e0 * c[6] - 0.2720908083525083608370563e-1 * c[
                    7] + 0.1045865435682921987447929e0 * c[4] - 0.1348436986667115543203552e1 * c[5],
                0.4227226173449345042468960e-3 * c[0] + 0.3088241944378964404772302e-3 * c[
                    1] + 0.2062575706647430620228133e-3 * c[2] + 0.3308343404200968256656458e-2 * c[
                    3] + 0.5828047016405001815804837e0 * c[4] + 0.8054174220366215473556835e0 * c[
                    6] + 0.1338363233410033443348225e0 * c[7] + 0.5555555555555555555555556e-2 * c[
                    8] + 0.1190362071861893051132274e1 * c[5],
                -0.8607044252686413302647675e-3 * c[3] - 0.1748074708673904989293256e0 * c[
                    4] - 0.3132544850115050165022338e0 * c[7] - 0.2500000000000000000000000e-1 * c[
                    8] - 0.3169166305310429271303167e0 * c[6] - 0.6691607091647929161078591e0 * c[5],
                0.3354661791693352108660900e-1 * c[4] - 0.3343620022386971405018586e0 * c[
                    6] + 0.5000000000000000000000000e-1 * c[8] + 0.2169790609807602750804271e0 * c[
                    5] + 0.1838363233410033443348225e0 * c[7],
                0.2912518476823004642951502e-1 * c[6] + 0.2279091916474916391629437e-1 * c[
                    7] - 0.3068985997518740530511593e-1 * c[5] - 0.1781799513347360596249022e-2 * c[
                    4] - 0.3055555555555555555555556e-1 * c[8]
            ], [
                0.1911888563316170927411831e-2 * c[3] - 0.4068130355529149936100229e-1 * c[
                    4] + 0.1319674981073749167009902e-1 * c[5] + 0.2557266518123783676349144e-1 * c[6],
                -0.4834791406446907590553793e-2 * c[3] + 0.2310683832687820403062715e0 * c[
                    4] - 0.1080774142196007991746827e0 * c[5] - 0.1181561776427343335410349e0 * c[6],
                -0.5111353189352474549563559e-2 * c[3] - 0.5355878163774754346032096e0 * c[
                    4] + 0.3328335104489738933610597e0 * c[5] + 0.2078656591178540157917135e0 * c[6],
                0.6697297488067662265210608e0 * c[4] - 0.5013247356072127938999311e0 * c[
                    5] - 0.1795161243106645437322408e0 * c[6],
                0.8671038084174692625075159e-2 * c[3] + 0.1736073411355428563685818e0 * c[
                    5] + 0.5331362125287625412555844e-1 * c[7] - 0.2424935262404526301801157e0 * c[
                    4] + 0.1569015257678588270609004e0 * c[6],
                -0.8607044252686413302647675e-3 * c[3] - 0.1748074708673904989293256e0 * c[
                    4] - 0.3132544850115050165022338e0 * c[7] - 0.2500000000000000000000000e-1 * c[
                    8] - 0.3169166305310429271303167e0 * c[6] - 0.6691607091647929161078591e0 * c[5],
                0.2239223735771599178951297e-3 * c[3] + 0.1275437785430956673825710e0 * c[
                    4] + 0.1011699483929608164601067e1 * c[5] + 0.9698817275172575247533506e0 * c[
                    7] + 0.1250000000000000000000000e0 * c[8] + 0.5555555555555555555555556e-2 * c[
                    9] + 0.4823177543031281500117826e0 * c[6],
                -0.3784113973033012949863031e-1 * c[4] - 0.2997556885134827361576001e0 * c[
                    5] - 0.3000000000000000000000000e0 * c[8] - 0.2500000000000000000000000e-1 * c[
                    9] - 0.3991486867446821178415359e0 * c[6] - 0.4382544850115050165022338e0 * c[7],
                0.4698146218022683933926520e-1 * c[5] - 0.2966863787471237458744416e0 * c[
                    7] + 0.5000000000000000000000000e-1 * c[9] + 0.1716355704146006481727960e0 * c[
                    6] + 0.3069346152296258362380356e-2 * c[4] + 0.1750000000000000000000000e0 * c[8]
            ], [
                0.1559652871136785763960685e-1 * c[4] - 0.6486184157331537899459796e-2 * c[
                    5] - 0.9110344554036319740147054e-2 * c[6],
                -0.8368141434403455353724691e-1 * c[4] + 0.4093499466767054661591066e-1 * c[
                    5] + 0.4274641967636400692133626e-1 * c[6],
                0.1824328174134289562208038e0 * c[4] - 0.1059816030196818445908057e0 * c[
                    5] - 0.7645121439374711162999809e-1 * c[6],
                -0.2022909060111751565150958e0 * c[4] + 0.1453421858063658498587377e0 * c[
                    5] + 0.5694872020480930665635812e-1 * c[6],
                -0.8631683980217122275970376e-1 * c[5] + 0.2698842360470999243492629e-1 * c[
                    6] + 0.8098194147715651085292754e-1 * c[4] - 0.3276463639080639163926118e-1 * c[7],
                0.3354661791693352108660900e-1 * c[4] - 0.3343620022386971405018586e0 * c[
                    6] + 0.5000000000000000000000000e-1 * c[8] + 0.2169790609807602750804271e0 * c[
                    5] + 0.1838363233410033443348225e0 * c[7],
                -0.3784113973033012949863031e-1 * c[4] - 0.2997556885134827361576001e0 * c[
                    5] - 0.3000000000000000000000000e0 * c[8] - 0.2500000000000000000000000e-1 * c[
                    9] - 0.3991486867446821178415359e0 * c[6] - 0.4382544850115050165022338e0 * c[7],
                0.1230328942716804455358698e-1 * c[4] + 0.1183647529645898332481833e0 * c[
                    5] + 0.9410511898227943334189628e0 * c[6] + 0.9500000000000000000000000e0 * c[
                    8] + 0.1250000000000000000000000e0 * c[9] + 0.5555555555555555555555556e-2 * c[
                    10] + 0.5699474344521144554459336e0 * c[7],
                -0.2308067892671916339568942e-1 * c[5] - 0.2986625053775149497180439e0 * c[
                    6] - 0.3000000000000000000000000e0 * c[9] - 0.2500000000000000000000000e-1 * c[
                    10] - 0.1047734860515050802561078e-2 * c[4] - 0.4272090808352508360837056e0 * c[
                    7] - 0.4250000000000000000000000e0 * c[8]
            ], [
                0.5593983696629863059347067e-3 * c[5] - 0.1384822535100796372263822e-2 * c[
                    4] + 0.8254241654378100663291154e-3 * c[6],
                -0.3576545132696983143406173e-2 * c[5] + 0.7389399124121078682094445e-2 * c[
                    4] - 0.3812853991424095538688273e-2 * c[6],
                0.9209089963443799485648361e-2 * c[5] - 0.1591502818872493167091475e-1 * c[
                    4] + 0.6705938225281132185266388e-2 * c[6],
                -0.1200429618441003833696998e-1 * c[5] - 0.4776915669385923841535432e-2 * c[
                    6] + 0.1678121185379596217850541e-1 * c[4],
                0.7462059484530855073291365e-2 * c[5] - 0.8121640361668678949573496e-3 * c[
                    6] + 0.5522702088127090209264064e-3 * c[7] - 0.7202165657176696199260422e-2 * c[4],
                0.2912518476823004642951502e-1 * c[6] + 0.2279091916474916391629437e-1 * c[
                    7] - 0.3068985997518740530511593e-1 * c[5] - 0.1781799513347360596249022e-2 * c[
                    4] - 0.3055555555555555555555556e-1 * c[8],
                0.4698146218022683933926520e-1 * c[5] - 0.2966863787471237458744416e0 * c[
                    7] + 0.5000000000000000000000000e-1 * c[9] + 0.1716355704146006481727960e0 * c[
                    6] + 0.3069346152296258362380356e-2 * c[4] + 0.1750000000000000000000000e0 * c[8],
                -0.2308067892671916339568942e-1 * c[5] - 0.2986625053775149497180439e0 * c[
                    6] - 0.3000000000000000000000000e0 * c[9] - 0.2500000000000000000000000e-1 * c[
                    10] - 0.1047734860515050802561078e-2 * c[4] - 0.4272090808352508360837056e0 * c[
                    7] - 0.4250000000000000000000000e0 * c[8],
                0.5139370221149109977041877e-2 * c[5] + 0.1247723215009422001393184e0 * c[
                    6] + 0.9505522702088127090209264e0 * c[7] + 0.9500000000000000000000000e0 * c[
                    9] + 0.1250000000000000000000000e0 * c[10] + 0.5555555555555555555555556e-2 * c[
                    11] + 0.9159362465153641826887659e-4 * c[4] + 0.5611111111111111111111111e0 * c[8]
            ]])

        M[m - 9:, m - 9:] = np.array([
            [
                0.5555555555555555555555556e-2 * c[m - 12] + 0.1250000000000000000000000e0 * c[
                    m - 11] + 0.9500000000000000000000000e0 * c[m - 10] + 0.9505522702088127090209264e0 * c[
                    m - 8] + 0.1247205076844361998744053e0 * c[m - 7] + 0.5139370221149109977041877e-2 * c[
                    m - 6] + 0.5611111111111111111111111e0 * c[m - 9] + 0.1434074411575366831819799e-3 * c[m - 5],
                -0.2500000000000000000000000e-1 * c[m - 11] - 0.3000000000000000000000000e0 * c[
                    m - 10] - 0.2980649679116425253322056e0 * c[m - 7] - 0.2308067892671916339568942e-1 * c[
                    m - 6] - 0.4250000000000000000000000e0 * c[m - 9] - 0.4272090808352508360837056e0 * c[
                    m - 8] - 0.1645272326387475188399322e-2 * c[m - 5],
                0.5000000000000000000000000e-1 * c[m - 10] - 0.2966863787471237458744416e0 * c[
                    m - 8] + 0.4698146218022683933926520e-1 * c[m - 6] + 0.1750000000000000000000000e0 * c[
                    m - 9] + 0.1700291833903489463825077e0 * c[m - 7] + 0.4675733176547960152668626e-2 * c[m - 5],
                0.2279091916474916391629437e-1 * c[m - 8] + 0.3097763128598982561225538e-1 * c[
                    m - 7] - 0.3055555555555555555555556e-1 * c[m - 9] - 0.3068985997518740530511593e-1 * c[
                    m - 6] - 0.3634246031107139778989373e-2 * c[m - 5],
                0.5522702088127090209264064e-3 * c[m - 8] - 0.3265435411305071914756373e-2 * c[
                    m - 7] + 0.7462059484530855073291365e-2 * c[m - 6] - 0.4748894282038492179461399e-2 * c[m - 5],
                0.6272075574042975468177820e-3 * c[m - 7] - 0.1200429618441003833696998e-1 * c[
                    m - 6] + 0.1137708862700574079015220e-1 * c[m - 5],
                0.9209089963443799485648361e-2 * c[m - 6] - 0.3129629392354775191148163e-3 * c[
                    m - 7] - 0.8896127024208321966533544e-2 * c[m - 5],
                -0.3576545132696983143406173e-2 * c[m - 6] + 0.4335019854436220306755673e-3 * c[
                    m - 7] + 0.3143043147253361112730605e-2 * c[m - 5],
                0.5593983696629863059347067e-3 * c[m - 6] - 0.1446656414398166805849327e-3 * c[
                    m - 7] - 0.4147327282231696253497740e-3 * c[m - 5]
            ], [
                -0.2500000000000000000000000e-1 * c[m - 11] - 0.3000000000000000000000000e0 * c[
                    m - 10] - 0.2980649679116425253322056e0 * c[m - 7] - 0.2308067892671916339568942e-1 * c[
                    m - 6] - 0.4250000000000000000000000e0 * c[m - 9] - 0.4272090808352508360837056e0 * c[
                    m - 8] - 0.1645272326387475188399322e-2 * c[m - 5],
                0.5555555555555555555555556e-2 * c[m - 11] + 0.1250000000000000000000000e0 * c[
                    m - 10] + 0.9500000000000000000000000e0 * c[m - 9] + 0.9341601509609901526962449e0 * c[
                    m - 7] + 0.1183647529645898332481833e0 * c[m - 6] + 0.1919432828897222527630486e-1 * c[
                    m - 5] + 0.5699474344521144554459336e0 * c[m - 8],
                -0.2500000000000000000000000e-1 * c[m - 10] - 0.3000000000000000000000000e0 * c[
                    m - 9] - 0.2997556885134827361576001e0 * c[m - 6] - 0.5636663150858098975790317e-1 * c[
                    m - 5] - 0.4382544850115050165022338e0 * c[m - 8] - 0.3806231949664312575822630e0 * c[m - 7],
                0.5000000000000000000000000e-1 * c[m - 9] - 0.3557251496099816106154206e0 * c[
                    m - 7] + 0.5490976528821799120017102e-1 * c[m - 5] + 0.1838363233410033443348225e0 * c[
                    m - 8] + 0.2169790609807602750804271e0 * c[m - 6],
                0.5528052133944605740009217e-1 * c[m - 7] - 0.8631683980217122275970376e-1 * c[
                    m - 6] - 0.3276463639080639163926118e-1 * c[m - 8] + 0.5268984374242044588776166e-1 * c[m - 5],
                -0.5373770512016897565958305e-2 * c[m - 7] + 0.1453421858063658498587377e0 * c[
                    m - 6] - 0.1399684152943489522927794e0 * c[m - 5],
                -0.1059816030196818445908057e0 * c[m - 6] + 0.1014880675788250237247178e0 * c[
                    m - 5] + 0.4493535440856820866087846e-2 * c[m - 7],
                0.4093499466767054661591066e-1 * c[m - 6] - 0.3471075437892810033585296e-1 * c[
                    m - 5] - 0.6224240288742446280057699e-2 * c[m - 7],
                -0.6486184157331537899459796e-2 * c[m - 6] + 0.4409068609809831485979484e-2 * c[
                    m - 5] + 0.2077115547521706413480312e-2 * c[m - 7]
            ], [
                0.5000000000000000000000000e-1 * c[m - 10] - 0.2966863787471237458744416e0 * c[
                    m - 8] + 0.4698146218022683933926520e-1 * c[m - 6] + 0.1750000000000000000000000e0 * c[
                    m - 9] + 0.1700291833903489463825077e0 * c[m - 7] + 0.4675733176547960152668626e-2 * c[m - 5],
                -0.2500000000000000000000000e-1 * c[m - 10] - 0.3000000000000000000000000e0 * c[
                    m - 9] - 0.2997556885134827361576001e0 * c[m - 6] - 0.5636663150858098975790317e-1 * c[
                    m - 5] - 0.4382544850115050165022338e0 * c[m - 8] - 0.3806231949664312575822630e0 * c[m - 7],
                0.5555555555555555555555556e-2 * c[m - 10] + 0.1250000000000000000000000e0 * c[
                    m - 9] + 0.9698817275172575247533506e0 * c[m - 8] + 0.1011699483929608164601067e1 * c[
                    m - 6] + 0.1773466968705924819112984e0 * c[m - 5] + 0.2239223735771599178951297e-3 * c[
                    m - 4] + 0.4325148359756313354830552e0 * c[m - 7],
                -0.2500000000000000000000000e-1 * c[m - 9] - 0.3132544850115050165022338e0 * c[
                    m - 8] - 0.2322389872063761557916742e0 * c[m - 5] - 0.8607044252686413302647675e-3 * c[
                    m - 4] - 0.2594851141920572702679681e0 * c[m - 7] - 0.6691607091647929161078591e0 * c[m - 6],
                0.5331362125287625412555844e-1 * c[m - 8] + 0.1736073411355428563685818e0 * c[
                    m - 6] + 0.8671038084174692625075159e-2 * c[m - 4] + 0.8084259844422177692569663e-1 * c[
                    m - 7] - 0.1664345989168155800449120e0 * c[m - 5],
                -0.5013247356072127938999311e0 * c[m - 6] + 0.5021853752328231128475915e0 * c[
                    m - 5] - 0.1197175073672143005877150e-1 * c[m - 7],
                0.3328335104489738933610597e0 * c[m - 6] - 0.3179803804558436283847901e0 * c[
                    m - 5] - 0.5111353189352474549563559e-2 * c[m - 4] - 0.9741776803777790426705996e-2 * c[m - 7],
                -0.1080774142196007991746827e0 * c[m - 6] + 0.9941834083648937298100811e-1 * c[
                    m - 5] - 0.4834791406446907590553793e-2 * c[m - 4] + 0.1349386478955833378422842e-1 * c[m - 7],
                0.1319674981073749167009902e-1 * c[m - 6] - 0.1060554802883657391328704e-1 * c[
                    m - 5] + 0.1911888563316170927411831e-2 * c[m - 4] - 0.4503090345217088684223814e-2 * c[m - 7]
            ], [
                0.2279091916474916391629437e-1 * c[m - 8] + 0.3097763128598982561225538e-1 * c[
                    m - 7] - 0.3055555555555555555555556e-1 * c[m - 9] - 0.3068985997518740530511593e-1 * c[
                    m - 6] - 0.3634246031107139778989373e-2 * c[m - 5],
                0.5000000000000000000000000e-1 * c[m - 9] - 0.3557251496099816106154206e0 * c[
                    m - 7] + 0.5490976528821799120017102e-1 * c[m - 5] + 0.1838363233410033443348225e0 * c[
                    m - 8] + 0.2169790609807602750804271e0 * c[m - 6],
                -0.2500000000000000000000000e-1 * c[m - 9] - 0.3132544850115050165022338e0 * c[
                    m - 8] - 0.2322389872063761557916742e0 * c[m - 5] - 0.8607044252686413302647675e-3 * c[
                    m - 4] - 0.2594851141920572702679681e0 * c[m - 7] - 0.6691607091647929161078591e0 * c[m - 6],
                0.5555555555555555555555556e-2 * c[m - 9] + 0.1338363233410033443348225e0 * c[
                    m - 8] + 0.7391887916719206077121040e0 * c[m - 7] + 0.6490333320052011212240632e0 * c[
                    m - 5] + 0.3308343404200968256656458e-2 * c[m - 4] + 0.2062575706647430620228133e-3 * c[
                    m - 3] + 0.3088241944378964404772302e-3 * c[m - 2] + 0.4227226173449345042468960e-3 * c[
                    m - 1] + 0.1190362071861893051132274e1 * c[m - 6],
                -0.2720908083525083608370563e-1 * c[m - 8] - 0.1931148612480615118957263e0 * c[
                    m - 7] - 0.3332941113251635390801278e-1 * c[m - 4] + 0.2605582646183255957264249e-3 * c[
                    m - 3] + 0.1432116665752147607469646e-2 * c[m - 2] + 0.1207544072304193806052558e-2 * c[
                    m - 1] - 0.1348436986667115543203552e1 * c[m - 6] + 0.1687723507780044227927853e-1 * c[m - 5],
                0.3590669644811151307464697e-1 * c[m - 7] - 0.5925443480724830632401754e0 * c[
                    m - 5] - 0.6897142765790609546343709e-2 * c[m - 3] - 0.5363098747528542488971874e-2 * c[
                    m - 2] - 0.5205147429855955657625694e-2 * c[m - 1] + 0.9977064356292750529201981e0 * c[m - 6],
                0.7272438906214475928744770e-1 * c[m - 5] + 0.1964682777744275219350831e-1 * c[
                    m - 4] - 0.5952475275883259619711594e-2 * c[m - 2] - 0.1635430866921887819487473e-2 * c[
                    m - 1] + 0.2921234010758621482958052e-1 * c[m - 7] - 0.4659516693228870973898560e0 * c[m - 6],
                0.5891947149681041048896399e-1 * c[m - 5] + 0.1858378996391679448655070e-1 * c[
                    m - 4] + 0.7240905383565181316381731e-2 * c[m - 3] + 0.2349927974590068869356781e-1 * c[
                    m - 1] - 0.4046360079256766884300687e-1 * c[m - 7] + 0.1223513270418807666970488e0 * c[m - 6],
                -0.2404661162020836566908542e-1 * c[m - 5] - 0.7348845587775519698437916e-2 * c[
                    m - 4] - 0.8105784530576404277872603e-3 * c[m - 3] + 0.9574633163221758060736592e-2 * c[
                    m - 2] - 0.1828896813877197352675410e-1 * c[m - 1] + 0.1350326632905990039353503e-1 * c[
                    m - 7] - 0.1315967038382618382356495e-1 * c[m - 6]
            ], [
                0.5522702088127090209264064e-3 * c[m - 8] - 0.3265435411305071914756373e-2 * c[
                    m - 7] + 0.7462059484530855073291365e-2 * c[m - 6] - 0.4748894282038492179461399e-2 * c[m - 5],
                0.5528052133944605740009217e-1 * c[m - 7] - 0.8631683980217122275970376e-1 * c[
                    m - 6] - 0.3276463639080639163926118e-1 * c[m - 8] + 0.5268984374242044588776166e-1 * c[m - 5],
                0.5331362125287625412555844e-1 * c[m - 8] + 0.1736073411355428563685818e0 * c[
                    m - 6] + 0.8671038084174692625075159e-2 * c[m - 4] + 0.8084259844422177692569663e-1 * c[
                    m - 7] - 0.1664345989168155800449120e0 * c[m - 5],
                -0.2720908083525083608370563e-1 * c[m - 8] - 0.1931148612480615118957263e0 * c[
                    m - 7] - 0.3332941113251635390801278e-1 * c[m - 4] + 0.2605582646183255957264249e-3 * c[
                    m - 3] + 0.1432116665752147607469646e-2 * c[m - 2] + 0.1207544072304193806052558e-2 * c[
                    m - 1] - 0.1348436986667115543203552e1 * c[m - 6] + 0.1687723507780044227927853e-1 * c[m - 5],
                0.6107825764368264576481962e-2 * c[m - 8] + 0.1155752633643216628010304e0 * c[
                    m - 7] + 0.2096413329579026439044119e1 * c[m - 6] + 0.3357721707576477199985656e0 * c[
                    m - 4] + 0.3291545083271862858501887e-3 * c[m - 3] + 0.6641183499427826101618457e-2 * c[
                    m - 2] + 0.3449455095910233625229891e-2 * c[m - 1] + 0.8270696421223286922584620e0 * c[m - 5],
                -0.4995827370863505253765970e-1 * c[m - 7] - 0.1263507837371824205693950e1 * c[
                    m - 6] - 0.8712928907711754187084757e-2 * c[m - 3] - 0.2487040599390160764166412e-1 * c[
                    m - 2] - 0.1486895819265604128572498e-1 * c[m - 1] - 0.1726565392121567634950213e1 * c[m - 5],
                0.5402985338373433052255418e0 * c[m - 6] - 0.1979290298620869974478871e0 * c[
                    m - 4] - 0.2760353365637712827793337e-1 * c[m - 2] - 0.4671751091575462868310238e-2 * c[
                    m - 1] - 0.6952587985456154591014641e-1 * c[m - 7] + 0.1571507277911208446562686e1 * c[m - 5],
                -0.1319358558853174530078498e0 * c[m - 6] - 0.1872196143003808021730728e0 * c[
                    m - 4] + 0.9147192682075630179962131e-2 * c[m - 3] + 0.6712774475803763988977355e-1 * c[
                    m - 1] + 0.9630407686703666967100804e-1 * c[m - 7] - 0.6882132817757726722141421e0 * c[m - 5],
                0.1241625568998496895352046e-1 * c[m - 6] + 0.7403484645316174090533193e-1 * c[
                    m - 4] - 0.1023976547309387874453988e-2 * c[m - 3] + 0.4440063948509876221050939e-1 * c[
                    m - 2] - 0.5224403464202056316702078e-1 * c[m - 1] - 0.3213800979246298453953842e-1 * c[
                    m - 7] + 0.1178181682424363524005403e0 * c[m - 5]
            ], [
                0.6272075574042975468177820e-3 * c[m - 7] - 0.1200429618441003833696998e-1 * c[
                    m - 6] + 0.1137708862700574079015220e-1 * c[m - 5],
                -0.5373770512016897565958305e-2 * c[m - 7] + 0.1453421858063658498587377e0 * c[
                    m - 6] - 0.1399684152943489522927794e0 * c[m - 5],
                -0.5013247356072127938999311e0 * c[m - 6] + 0.5021853752328231128475915e0 * c[
                    m - 5] - 0.1197175073672143005877150e-1 * c[m - 7],
                0.3590669644811151307464697e-1 * c[m - 7] - 0.5925443480724830632401754e0 * c[
                    m - 5] - 0.6897142765790609546343709e-2 * c[m - 3] - 0.5363098747528542488971874e-2 * c[
                    m - 2] - 0.5205147429855955657625694e-2 * c[m - 1] + 0.9977064356292750529201981e0 * c[m - 6],
                -0.4995827370863505253765970e-1 * c[m - 7] - 0.1263507837371824205693950e1 * c[
                    m - 6] - 0.8712928907711754187084757e-2 * c[m - 3] - 0.2487040599390160764166412e-1 * c[
                    m - 2] - 0.1486895819265604128572498e-1 * c[m - 1] - 0.1726565392121567634950213e1 * c[m - 5],
                0.2760393423824887721078848e-1 * c[m - 7] + 0.1190550338687608873798462e1 * c[
                    m - 6] + 0.4253084328734353394994388e1 * c[m - 5] + 0.2306367624634749229113646e0 * c[
                    m - 3] + 0.9313657638804699948929701e-1 * c[m - 2] + 0.6409299775987186986730499e-1 * c[m - 1],
                -0.8755807343482262259774782e0 * c[m - 6] - 0.3645285178085761821545207e1 * c[
                    m - 5] + 0.1033717994630886401730470e0 * c[m - 2] + 0.2013769413884797246646959e-1 * c[
                    m - 1] + 0.4106783858513785463625543e-1 * c[m - 7],
                0.3956598149904136332753521e0 * c[m - 6] + 0.1630560443616104907615866e1 * c[
                    m - 5] - 0.2421320004064592721552708e0 * c[m - 3] - 0.2893557395653431666593814e0 * c[
                    m - 1] - 0.5688529641249387985434413e-1 * c[m - 7],
                -0.7684117160199014594442072e-1 * c[m - 6] - 0.2928439026361256842196229e0 * c[
                    m - 5] + 0.2710530961648671297733465e-1 * c[m - 3] - 0.1662748711097054895317080e0 * c[
                    m - 2] + 0.2251991532891353212689574e0 * c[m - 1] + 0.1898341454096471754822498e-1 * c[m - 7]
            ], [
                0.9209089963443799485648361e-2 * c[m - 6] - 0.3129629392354775191148163e-3 * c[
                    m - 7] - 0.8896127024208321966533544e-2 * c[m - 5],
                -0.1059816030196818445908057e0 * c[m - 6] + 0.1014880675788250237247178e0 * c[
                    m - 5] + 0.4493535440856820866087846e-2 * c[m - 7],
                0.3328335104489738933610597e0 * c[m - 6] - 0.3179803804558436283847901e0 * c[
                    m - 5] - 0.5111353189352474549563559e-2 * c[m - 4] - 0.9741776803777790426705996e-2 * c[m - 7],
                0.7272438906214475928744770e-1 * c[m - 5] + 0.1964682777744275219350831e-1 * c[
                    m - 4] - 0.5952475275883259619711594e-2 * c[m - 2] - 0.1635430866921887819487473e-2 * c[
                    m - 1] + 0.2921234010758621482958052e-1 * c[m - 7] - 0.4659516693228870973898560e0 * c[m - 6],
                0.5402985338373433052255418e0 * c[m - 6] - 0.1979290298620869974478871e0 * c[
                    m - 4] - 0.2760353365637712827793337e-1 * c[m - 2] - 0.4671751091575462868310238e-2 * c[
                    m - 1] - 0.6952587985456154591014641e-1 * c[m - 7] + 0.1571507277911208446562686e1 * c[m - 5],
                -0.8755807343482262259774782e0 * c[m - 6] - 0.3645285178085761821545207e1 * c[
                    m - 5] + 0.1033717994630886401730470e0 * c[m - 2] + 0.2013769413884797246646959e-1 * c[
                    m - 1] + 0.4106783858513785463625543e-1 * c[m - 7],
                0.1070920689960817104203947e1 * c[m - 6] + 0.3717418466925056542408153e1 * c[
                    m - 5] + 0.1166740554279680007487795e0 * c[m - 4] + 0.1147318200715868527529827e0 * c[
                    m - 2] + 0.6327161147136873807796515e-2 * c[m - 1] + 0.6235373239336055200426697e-1 * c[m - 7],
                -0.6639605248735044787146222e0 * c[m - 6] - 0.1865625445986772763641423e1 * c[
                    m - 5] + 0.1103611313171476425250639e0 * c[m - 4] - 0.9091410269992464604926176e-1 * c[
                    m - 1] - 0.8636954541126674177407762e-1 * c[m - 7],
                0.1582127073537215443965653e0 * c[m - 6] + 0.3746489300753517635549495e0 * c[
                    m - 5] - 0.4364163147111892346990101e-1 * c[m - 4] - 0.1845476106024151050283847e0 * c[
                    m - 2] + 0.7075642937243715046279337e-1 * c[m - 1] + 0.2882271848190011329385407e-1 * c[m - 7]
            ], [
                -0.3576545132696983143406173e-2 * c[m - 6] + 0.4335019854436220306755673e-3 * c[
                    m - 7] + 0.3143043147253361112730605e-2 * c[m - 5],
                0.4093499466767054661591066e-1 * c[m - 6] - 0.3471075437892810033585296e-1 * c[
                    m - 5] - 0.6224240288742446280057699e-2 * c[m - 7],
                -0.1080774142196007991746827e0 * c[m - 6] + 0.9941834083648937298100811e-1 * c[
                    m - 5] - 0.4834791406446907590553793e-2 * c[m - 4] + 0.1349386478955833378422842e-1 * c[m - 7],
                0.5891947149681041048896399e-1 * c[m - 5] + 0.1858378996391679448655070e-1 * c[
                    m - 4] + 0.7240905383565181316381731e-2 * c[m - 3] + 0.2349927974590068869356781e-1 * c[
                    m - 1] - 0.4046360079256766884300687e-1 * c[m - 7] + 0.1223513270418807666970488e0 * c[m - 6],
                -0.1319358558853174530078498e0 * c[m - 6] - 0.1872196143003808021730728e0 * c[
                    m - 4] + 0.9147192682075630179962131e-2 * c[m - 3] + 0.6712774475803763988977355e-1 * c[
                    m - 1] + 0.9630407686703666967100804e-1 * c[m - 7] - 0.6882132817757726722141421e0 * c[m - 5],
                0.3956598149904136332753521e0 * c[m - 6] + 0.1630560443616104907615866e1 * c[
                    m - 5] - 0.2421320004064592721552708e0 * c[m - 3] - 0.2893557395653431666593814e0 * c[
                    m - 1] - 0.5688529641249387985434413e-1 * c[m - 7],
                -0.6639605248735044787146222e0 * c[m - 6] - 0.1865625445986772763641423e1 * c[
                    m - 5] + 0.1103611313171476425250639e0 * c[m - 4] - 0.9091410269992464604926176e-1 * c[
                    m - 1] - 0.8636954541126674177407762e-1 * c[m - 7],
                0.4681819359722749441073885e0 * c[m - 6] + 0.1015239189167790053447110e1 * c[
                    m - 5] + 0.1043897828092562609502636e0 * c[m - 4] + 0.2542001760457345743492403e0 * c[
                    m - 3] + 0.1306332157111667628555907e1 * c[m - 1] + 0.1196351539550049336518187e0 * c[m - 7],
                -0.1195777325611201766551392e0 * c[m - 6] - 0.2187310061229745694542609e0 * c[
                    m - 5] - 0.4128029838349298819825156e-1 * c[m - 4] - 0.2845627370491611369031341e-1 * c[
                    m - 3] - 0.1016689339350338144430605e1 * c[m - 1] - 0.3992391469197282238624438e-1 * c[m - 7]
            ], [
                0.5593983696629863059347067e-3 * c[m - 6] - 0.1446656414398166805849327e-3 * c[
                    m - 7] - 0.4147327282231696253497740e-3 * c[m - 5],
                -0.6486184157331537899459796e-2 * c[m - 6] + 0.4409068609809831485979484e-2 * c[
                    m - 5] + 0.2077115547521706413480312e-2 * c[m - 7],
                0.1319674981073749167009902e-1 * c[m - 6] - 0.1060554802883657391328704e-1 * c[
                    m - 5] + 0.1911888563316170927411831e-2 * c[m - 4] - 0.4503090345217088684223814e-2 * c[m - 7],
                -0.2404661162020836566908542e-1 * c[m - 5] - 0.7348845587775519698437916e-2 * c[
                    m - 4] - 0.8105784530576404277872603e-3 * c[m - 3] + 0.9574633163221758060736592e-2 * c[
                    m - 2] - 0.1828896813877197352675410e-1 * c[m - 1] + 0.1350326632905990039353503e-1 * c[
                    m - 7] - 0.1315967038382618382356495e-1 * c[m - 6],
                0.1241625568998496895352046e-1 * c[m - 6] + 0.7403484645316174090533193e-1 * c[
                    m - 4] - 0.1023976547309387874453988e-2 * c[m - 3] + 0.4440063948509876221050939e-1 * c[
                    m - 2] - 0.5224403464202056316702078e-1 * c[m - 1] - 0.3213800979246298453953842e-1 * c[
                    m - 7] + 0.1178181682424363524005403e0 * c[m - 5],
                -0.7684117160199014594442072e-1 * c[m - 6] - 0.2928439026361256842196229e0 * c[
                    m - 5] + 0.2710530961648671297733465e-1 * c[m - 3] - 0.1662748711097054895317080e0 * c[
                    m - 2] + 0.2251991532891353212689574e0 * c[m - 1] + 0.1898341454096471754822498e-1 * c[m - 7],
                0.1582127073537215443965653e0 * c[m - 6] + 0.3746489300753517635549495e0 * c[
                    m - 5] - 0.4364163147111892346990101e-1 * c[m - 4] - 0.1845476106024151050283847e0 * c[
                    m - 2] + 0.7075642937243715046279337e-1 * c[m - 1] + 0.2882271848190011329385407e-1 * c[m - 7],
                -0.1195777325611201766551392e0 * c[m - 6] - 0.2187310061229745694542609e0 * c[
                    m - 5] - 0.4128029838349298819825156e-1 * c[m - 4] - 0.2845627370491611369031341e-1 * c[
                    m - 3] - 0.1016689339350338144430605e1 * c[m - 1] - 0.3992391469197282238624438e-1 * c[m - 7],
                0.3167964748016105299646518e-1 * c[m - 6] + 0.4976563420877041544013670e-1 * c[
                    m - 5] + 0.1632404042590951953384672e-1 * c[m - 4] + 0.3185519088796429015220016e-2 * c[
                    m - 3] + 0.2968472090638000742888467e0 * c[m - 2] + 0.7912667594695582093926295e0 * c[
                    m - 1] + 0.1332316557164627464149716e-1 * c[m - 7]
            ]])

        M[4, 9] = M[9, 4]
        M[m - 5, m - 10] = M[m - 10, m - 5]
        M = (M / h).tocsr()
        D2 = HI @ (-M - spsp.diags(c, shape=(m, m)) @ ((e_l @ d1_l.transpose()) - (e_r @ d1_r.transpose())))
        return D2

    return H, HI, D1, D2_fun, e_l, e_r, d1_l, d1_r
